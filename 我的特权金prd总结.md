# 我的特权金（页面ID：600045）

全局说明：

- 为你推荐统一逻辑
- 全平台统一无网/异常处理

## 页面说明

- 返回按钮：点击返回上一级页面
- 标题文案：取配置，托底“我的福利”
- Tab：
  - 未使用、已使用/已过期
  - 点击切换
  - Tab吸顶
- 规则H5页面ID：600043

### 未使用

- 默认进入“未使用”
  - 加载20条数据；
  - 可下拉刷新（刷新Tab）；
  - 切换Tab重新加载20条数据；
  - 每次上拉加载20条数据
- 无数据见UI，文案为前端写死“暂时还没有福利哦”
- 未使用Tab下的特权金有两种状态，“未使用”和“冻结中”
- 背景图取配置
- 名称取配置
- 券金额最多4位
- 使用说明，默认一行
- 特权金有效期与按钮样式
  - 未使用的特权金显示到期倒计时，文案为“dd天hh:mm:ss后作废“，小于一天不展示天数；
  - 未使用的按钮为”立即使用“，点击跳转特权金商品集合页；
  - 冻结中的特权金显示支付倒计时，文案为”订单还剩：hh:mm:ss关闭“
  - 冻结中的特权金倒计时为0时，如果还在特权金有效期内，则进入未使用状态；如果不在有效期中，自动进入已过期状态；
  - 冻结中的按钮为”去支付“，点击跳转到对应订单详情页
- 为你推荐
  - 没有一张特权金时，下方就展示”为你推荐“，下拉刷新时刷新券列表以及为你推荐商品列表；
  - 有特权金时，最后一张特权金下方展示”为你推荐“。刷新逻辑：下拉刷新或进入页面刷新时，先刷新特权金列表，如果特权金数据加载完毕，加载为你推荐；如果分页未加载完，上拉继续加载特权金数据，直到特权金数据加载完的同时再加载为你推荐

### 已使用/已过期

- 进入tab页时，加载20条数据；可下拉刷新；切tab重新加载20条；上拉加载20条；
- 无数据见UI，文案为前端写死“您的福利空空如也～”
- tab下有“已使用”、“已过期”两种状态特权金
- 背景图置灰
- 名称
- 金额
- 按钮：已使用、已过期，不可点击
- 时间展示规则：
  - 已使用状态：时间取交易系统的特权金使用时间，精确到分，文案为“使用时间：yyyy-mm-dd hh:mm“，如”使用时间：2021-03-20 18:12“
  - 已过期状态：过期时间取交易系统特权金失效时间，精确到分，文案为”过期时间：yyyy-mm-dd hh:mm“

### DRD内容

- Tab栏只可选中一个，且选中后再次点击同一个无交互，未选中的则被选中并刷新页面数据
- 未使用特权金卡片：
  - 面额，个、十和百、千的样式不同（实际UI上，个和十相同，而非十和百相同）
  - 名称：超出截断，UI给最大宽度
  - 倒计时文案：单行文本，具体时间数字需要完整展示；
  - 使用说明：
    - 默认为收起状态，超出展示...，若文案没有超出UI宽度，则不展示按钮
  - 按钮宽度固定，文案变换
- 已使用/已过期特权金卡片：
  - 同上，唯一注意已使用/已过期的标识见UI。

### 为你推荐

1. 数据源，略；
2. 标题：托底“为你推荐”；
3. 商品模块：同feed流；
4. 如无推荐商品数据，或推荐接口异常时，不显示为你推荐模块（标题+商品）；
5. 无更多推荐商品时，显示“没有更多了”，参考UI；
6. 分页显示，一页20条，正常网络环境下要求1s内加载完。
7. 商品模块：
   - 商品图片，取审核通过图，无则取正方形入口图，托底UI给出；
   - 商品价格，取默认商品原价；显示为¥A，支持到两位小数，不默认补0；
   - 渠道积分优惠金额功能展示逻辑：
     - 如果商品仅支持纯价格购买，不支持积分兑换，或者积分优惠金额小于1元时，不展示此模块；
     - 渠道积分优惠金额取值：默认sku积分优惠金额；渠道积分的名称取各个渠道的配置名；
     - 显示为：“{渠道积分}可省¥A“，长度以UI为准，超出显示...，未配置、获取失败不展示。
   - 制造商背景：见全局说明的制造商背景取值，单行，超出显示...；
   - 商品名称：取商品短标题，单行超出...；
   - 好评数：取值见后段评论服务系统，具体PRD为【鸿源-CP-PRD-鸿源嵌入式合作 V1.0.0-评论服务-渠道评论】的4.8章节的前端显示逻辑
     - 小于一万条显示全部数字；
     - 大于等于一万显示成x.yw条好评，精确小数点后一位，四舍五入；
     - 没有评价信息则隐藏此标签；
   - 点击事件：点击跳转到当前商品的商品编辑器页。从商品编辑器返回页面不刷新，位置不偏移。

### 尚未确认事项

1. 下拉刷新加载样式，需仔细查看prd、drd、设计图；
2. 上滑后加载中的样式；
3. 无结果已编码，网络异常的暂未确定图片、文案，需看prd、drd；
4. countdown待欣宇提交代码后确认；（已确认无误）
5. 特权金说明不足一行不展示按钮，待完善；
6. 为你推荐的逻辑如何使用；
7. van-pull-refresh的高度如果不够，下方内容在下拉加载时会被遮住？