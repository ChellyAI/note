## **HTTP版本之间差异**

### **HTTP 0.9**

最初的版本，只有一个`GET`请求，只支持纯文本内容

### **HTTP 1.0**

- 任何格式内容都能发送，使互联网不仅可以传输文字，还能传输图像、视频、二进制文件
- 除了`GET`，增加了`POST`和`HEAD`命令
- `http`请求和响应格式改变，除了数据部分，每次通信都必须包括头信息（`header`）用来描述一些元数据
- 只是用`header`中的 `If-Modified-Since` 和 `Expires` 作为缓存失效的标准
- 不支持断点续传，每次都会传送全部页面和数据
- 每台计算机只能绑定一个 `IP` ，所以请求消息中的 `URL` 并没有传递主机名（hostname）

### **HTTP 1.1**

目前最为主流的 `http` 协议版本，从99年发布至今，仍是主流
- 引入了持久连接（`persistent connection`），即 `TCP` 连接默认不关闭，可以被多个请求复用，不用声明 `Connection: keep-alive` 。长连接的连接时长可以通过请求头中的 `keep-alive` 来设置
- 引入了管道机制（`pipelining`），即在同一个 `TCP` 连接里，客户端可以同时发送多个请求，进一步改进了 `HTTP` 协议的效率
- `HTTP 1.1` 中新增加了 `E-tag，If-Unmodified-Since, If-Match, If-None-Match` 等缓存控制标头来控制缓存失效。
- 支持断点续传，通过使用请求头中的 `Range` 来实现。
- 使用了虚拟网络，在一台物理服务器上可以存在多个虚拟主机（`Multi-homed Web Servers`），并且它们共享一个 `IP` 地址。
- 新增方法：`PUT、 PATCH、 OPTIONS、 DELETE`。

### **HTTP 1.x问题**

- 在传输数据过程中，所有内容都是明文，客户端和服务器端都无法验证对方的身份，无法保证数据的安全性。
-  `HTTP/1.1` 版本默认允许复用TCP连接，但是在同一个TCP连接里，所有数据通信是按次序进行的，服务器通常在处理完一个回应后，才会继续去处理下一个，这样子就会造成队头阻塞。
- `HTTP/1.x` 版本支持 `Keep-alive`，用此方案来弥补创建多次连接产生的延迟，但是同样会给服务器带来压力，并且的话，对于单文件被不断请求的服务，`Keep-alive` 会极大影响性能，因为它在文件被请求之后还保持了不必要的连接很长时间。

### **HTTP 2.0**

- **二进制分帧**：头信息和数据体都是二进制，统称为“帧”，头部信息帧和数据帧。将请求及响应包含的信息拆分为多个帧，对其顺序标识后乱序发送，首部封装到 `HEADER frame` 中，请求体封装到 `DATA frame` 中，各帧之间互不依赖、互不干扰
- **多路复用**：复用 `TCP` 连接，在一个连接里，客户端和浏览器都可以同时发送多个请求或回应，且不用按顺序一一对应，这样子解决了队头阻塞的问题。
- **头部压缩**： `HTTP 1.1` 版本会出现 `「User-Agent、Cookie、Accept、Server、Range」` 等字段可能会占用几百甚至几千字节，而 `Body` 却经常只有几十字节，所以导致头部偏重。`HTTP 2.0` 使用 `HPACK` 算法进行压缩。
- **服务器推送**：支持服务器未经请求，主动向客户端发送资源，即服务器推送
- **请求优先级**： 可以设置数据帧的优先级，让服务端先处理重要资源，优化用户体验
